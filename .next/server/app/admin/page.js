(()=>{var e={};e.id=3,e.ids=[3],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},9269:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>l}),t(3389),t(893),t(7873),t(996);var r=t(170),a=t(5002),i=t(3876),n=t.n(i),o=t(6299),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(s,d);let l=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3389)),"/Users/jasonculbertson/Documents/GitHub/powerwatch/app/admin/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,893)),"/Users/jasonculbertson/Documents/GitHub/powerwatch/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,7873)),"/Users/jasonculbertson/Documents/GitHub/powerwatch/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,996,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/jasonculbertson/Documents/GitHub/powerwatch/app/admin/page.tsx"],m="/admin/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},3563:(e,s,t)=>{Promise.resolve().then(t.bind(t,3957))},4425:(e,s,t)=>{Promise.resolve().then(t.bind(t,5150))},7313:(e,s,t)=>{Promise.resolve().then(t.bind(t,4963)),Promise.resolve().then(t.bind(t,7734)),Promise.resolve().then(t.t.bind(t,4080,23))},2737:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,3642,23)),Promise.resolve().then(t.t.bind(t,7586,23)),Promise.resolve().then(t.t.bind(t,7838,23)),Promise.resolve().then(t.t.bind(t,8057,23)),Promise.resolve().then(t.t.bind(t,7741,23)),Promise.resolve().then(t.t.bind(t,3118,23))},3957:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});var r=t(7247);function a({children:e}){return r.jsx(r.Fragment,{children:e})}},5150:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var r=t(7247),a=t(8964),i=t(2448);let n=[{id:"E-1-ALL",name:"E-1",description:"Flat Rate (Tiered Pricing)",season:"All Year"},{id:"E-TOU-C-W",name:"E-TOU-C",description:"Time-of-Use (4-9pm Peak)",season:"Winter"},{id:"E-TOU-C-S",name:"E-TOU-C",description:"Time-of-Use (4-9pm Peak)",season:"Summer"},{id:"E-TOU-D-W",name:"E-TOU-D",description:"Time-of-Use (3-8pm Peak)",season:"Winter"},{id:"E-TOU-D-S",name:"E-TOU-D",description:"Time-of-Use (3-8pm Peak)",season:"Summer"},{id:"EV2-A-W",name:"EV2-A",description:"Time-of-Use (EV Owners)",season:"Winter"},{id:"EV2-A-S",name:"EV2-A",description:"Time-of-Use (EV Owners)",season:"Summer"}];function o(){let[e,s]=(0,a.useState)(null),[t,o]=(0,a.useState)(null),d=async e=>{try{let s,t;o(null),console.log("Starting PDF processing for path:",e),console.log("Sending PDF path for processing:",e);try{s=await fetch("/api/parse-pdf",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({pdfPath:e})})}catch(e){throw console.error("Network error:",e),Error("Failed to connect to server")}let r=await s.text();console.log("Raw server response:",r);try{t=JSON.parse(r),console.log("Parsed server response:",t)}catch(e){throw console.error("Error parsing server response:",{status:s.status,statusText:s.statusText,rawResponse:r,parseError:e}),Error("Server returned invalid JSON response")}if(!s.ok){let e=t.details||t.error||"Failed to parse PDF";throw console.error("Server error:",{status:s.status,statusText:s.statusText,data:t}),Error(e)}o(t),console.log("PDF parsed successfully")}catch(e){console.error("PDF processing error:",{message:e instanceof Error?e.message:"Unknown error",error:e,stack:e instanceof Error?e.stack:void 0}),o({error:!0,message:e instanceof Error?e.message:"Failed to process PDF",timestamp:new Date().toISOString(),details:e instanceof Error?e.stack:void 0})}},[l,c]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[u,p]=(0,a.useState)([]),[h,g]=(0,a.useState)(""),b=async e=>{try{let{data:s,error:t}=await i.O.storage.from("pdfs").download(e);if(t)throw t;let r=URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=e.split("/").pop()||"download.pdf",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}catch(e){console.error("Error downloading file:",e),g(e.message)}},j=async()=>{try{await i.O.auth.signOut(),window.location.replace("/admin/login")}catch(e){console.error("Error signing out:",e),g(e.message)}};return m?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:r.jsx("div",{className:"text-xl font-semibold text-gray-800",children:"Loading..."})}):l?r.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:r.jsx("div",{className:"max-w-7xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Logged in as: ",l.email]})]}),r.jsx("button",{onClick:j,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Sign Out"})]}),h&&r.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:r.jsx("p",{className:"text-red-600",children:h})}),t&&(0,r.jsxs)("div",{className:`mb-8 p-4 bg-white border rounded-lg shadow-sm ${t.error?"border-red-200":"border-gray-200"}`,children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:t.error?"PDF Parsing Error":"Parsed PDF Results"}),t.error?(0,r.jsxs)("div",{className:"bg-red-50 p-4 rounded",children:[(0,r.jsxs)("p",{className:"text-red-700 mb-2",children:["Error: ",t.message]}),(0,r.jsxs)("p",{className:"text-red-500 text-sm",children:["Time: ",new Date(t.timestamp).toLocaleString()]})]}):(0,r.jsxs)("div",{children:[r.jsx("div",{className:"mb-4",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Total Pages: ",t.totalPages]})}),r.jsx("div",{className:"space-y-6",children:t.error?(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:[r.jsx("h3",{className:"text-md font-medium text-red-800 mb-2",children:"Error Processing PDF"}),r.jsx("p",{className:"text-sm text-red-600",children:t.details||t.message})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-md font-medium text-gray-800 mb-2",children:"PDF Information"}),(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded text-sm space-y-1",children:[t.metadata?.title&&(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"Title:"})," ",t.metadata.title]}),t.metadata?.author&&(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"Author:"})," ",t.metadata.author]}),t.metadata?.pageCount&&(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"Pages:"})," ",t.metadata.pageCount]}),t.metadata?.version&&(0,r.jsxs)("p",{children:[r.jsx("span",{className:"font-medium",children:"PDF Version:"})," ",t.metadata.version]})]})]}),t.pages?.map((e,s)=>r.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[r.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:r.jsxs("h3",{className:"text-sm font-medium text-gray-700",children:["Page ",e.pageNumber]})}),r.jsx("pre",{className:"p-4 text-sm whitespace-pre-wrap overflow-auto max-h-[400px] bg-white",children:e.content})]},s))]})})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Info"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate Schedule"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Energy Usage (kWh)"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===u.length?r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-4 py-4 text-center text-gray-500",children:"No submissions found"})}):u.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-4 py-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),r.jsx("div",{className:"text-sm text-gray-500",children:e.email}),r.jsx("div",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleString()})]}),(0,r.jsxs)("td",{className:"px-4 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900",children:n.find(s=>s.id===e.rate_schedule)?.name||"-"}),r.jsx("div",{className:"text-sm text-gray-500",children:n.find(s=>s.id===e.rate_schedule)?.description||"-"}),r.jsx("div",{className:"text-xs text-gray-400",children:n.find(s=>s.id===e.rate_schedule)?.season||"-"})]}),r.jsx("td",{className:"px-4 py-4",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium",children:"Peak:"})," ",e.peak_kwh?.toFixed(2)||"-"," kWh"]}),(0,r.jsxs)("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium",children:"Off-Peak:"})," ",e.offpeak_kwh?.toFixed(2)||"-"," kWh"]})]})}),r.jsx("td",{className:"px-4 py-4 text-sm",children:(0,r.jsxs)("div",{className:"space-y-2",children:[e.pdf_path&&r.jsx("button",{onClick:()=>d(e.pdf_path),className:"inline-flex items-center text-xs text-blue-600 hover:text-blue-800 mr-4",children:"Parse PDF"}),e.pdf_path&&r.jsx("button",{onClick:()=>b(e.pdf_path),className:"block w-full px-3 py-1 text-center text-indigo-600 hover:text-indigo-900 border border-indigo-600 rounded hover:bg-indigo-50",children:"Download PDF"}),r.jsx("button",{onClick:()=>console.log("View details:",e.id),className:"block w-full px-3 py-1 text-center text-gray-600 hover:text-gray-900 border border-gray-300 rounded hover:bg-gray-50",children:"Edit Details"})]})})]},e.id))})]})})})]})})}):(window.location.replace("/admin/login"),null)}},4963:(e,s,t)=>{"use strict";t.d(s,{ProgressProvider:()=>n,S:()=>o});var r=t(7247),a=t(8964);let i=(0,a.createContext)(void 0);function n({children:e}){let[s,t]=(0,a.useState)(0),[n,o]=(0,a.useState)("Input");return r.jsx(i.Provider,{value:{progress:s,setProgress:t,currentStep:n,setCurrentStep:o},children:e})}function o(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useProgress must be used within a ProgressProvider");return e}},7734:(e,s,t)=>{"use strict";t.d(s,{AuthProvider:()=>o});var r=t(7247),a=t(8964),i=t(2448);let n=(0,a.createContext)(void 0);function o({children:e}){let[s,t]=(0,a.useState)(null),[o,d]=(0,a.useState)(!0),l=async(e,s)=>{let{error:t}=await i.O.auth.signInWithPassword({email:e,password:s});if(t)throw t},c=async()=>{let{error:e}=await i.O.auth.signOut();if(e)throw e};return r.jsx(n.Provider,{value:{user:s,loading:o,signIn:l,signOut:c},children:e})}},2448:(e,s,t)=>{"use strict";t.d(s,{O:()=>r});let r=(0,t(6210).eI)("https://umuqydzeqqifiywqsxec.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtdXF5ZHplcXFpZml5d3FzeGVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg5ODM5NzMsImV4cCI6MjA1NDU1OTk3M30.2cudPRraCD6W4oolwfnH5ZYm1CN9FOSkrs-brtsEEbk",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},893:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(5347).createProxy)(String.raw`/Users/jasonculbertson/Documents/GitHub/powerwatch/app/admin/layout.tsx#default`)},3389:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(5347).createProxy)(String.raw`/Users/jasonculbertson/Documents/GitHub/powerwatch/app/admin/page.tsx#default`)},7873:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m,metadata:()=>c});var r=t(2051),a=t(1312),i=t.n(a);t(7272);var n=t(5347);let o=(0,n.createProxy)(String.raw`/Users/jasonculbertson/Documents/GitHub/powerwatch/components/providers/progress-provider.tsx#ProgressProvider`);(0,n.createProxy)(String.raw`/Users/jasonculbertson/Documents/GitHub/powerwatch/components/providers/progress-provider.tsx#useProgress`);let d=(0,n.createProxy)(String.raw`/Users/jasonculbertson/Documents/GitHub/powerwatch/lib/auth-context.tsx#AuthProvider`);(0,n.createProxy)(String.raw`/Users/jasonculbertson/Documents/GitHub/powerwatch/lib/auth-context.tsx#useAuth`);var l=t(2349);let c={title:"PG&E Savings Calculator",description:"Find out how much you can save on your PG&E bill"};function m({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:i().className,children:r.jsx(d,{children:r.jsx(o,{children:(0,r.jsxs)("div",{className:"min-h-screen gradient-background",children:[r.jsx("header",{className:"py-4",children:r.jsx("div",{className:"container mx-auto px-4",children:r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(l.default,{href:"/",className:"text-xl font-bold",children:"PG&E Saver"})})})})}),r.jsx("main",{children:e})]})})})})})}},7272:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[787,98],()=>t(9269));module.exports=r})();