(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{5366:function(e,t,s){Promise.resolve().then(s.bind(s,2463))},2463:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var a=s(7437),r=s(2265),n=s(9376),l=s(5368),i=s(7689),d=s(8736),o=s(9658),c=s(2489),m=s(9345),u=s(2660),f=s(6858),x=s(2141),p=s(458),h=s(4508);let g=p.zt,b=p.fC,j=p.xz,v=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...n}=e;return(0,a.jsx)(p.VY,{ref:t,sideOffset:r,className:(0,h.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})});v.displayName=p.VY.displayName;let N=(0,s(535).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),w=r.forwardRef((e,t)=>{let{className:s,variant:r,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,h.cn)(N({variant:r}),s),...n})});w.displayName="Alert",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,h.cn)("mb-1 font-medium leading-none tracking-tight",s),...r})}).displayName="AlertTitle";let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,h.cn)("text-sm [&_p]:leading-relaxed",s),...r})});y.displayName="AlertDescription";var k=s(3145),C=s(6070);function E(e){let{steps:t}=e;return(0,a.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex-none",children:(0,a.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-accent text-sm font-medium text-primary",children:t+1})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-medium mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]})]},t))})}function F(){return(0,a.jsx)(C.Zb,{className:"mb-6 p-6",children:(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2 items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"How to Download Your PG&E Bill"}),(0,a.jsx)(E,{steps:[{title:"Go to PG&E website",description:"Visit pge.com in your web browser"},{title:"Sign in to your account",description:"Click the 'Sign In' button in the top right corner and enter your credentials"},{title:"Find your current bill",description:"Look for the 'View Current Bill (PDF)' link"},{title:"Download the PDF",description:"Click the link and your bill will automatically download to your computer"}]})]}),(0,a.jsx)("div",{className:"relative aspect-[16/10] rounded-lg overflow-hidden border",children:(0,a.jsx)(k.default,{src:"https://sjc.microlink.io/dc-VF2I4unTXM8wELKIRPv4PW5mOEv-iVQZmsZvTV86OEnx4rh2K6VwFcxvuOwNgAbaUx8Qy7YYuCFYMuoWswg.jpeg",alt:"PG&E website screenshot showing where to find your bill",fill:!0,className:"object-cover"})})]})})}var S=s(401);function P(e){let{currentStep:t,steps:s}=e;return(0,a.jsx)("div",{className:"flex items-center justify-center space-x-4 mb-8",children:s.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full border-2 ".concat(r<t?"bg-accent border-accent text-accent-foreground":r===t?"border-accent text-accent":"border-muted-foreground text-muted-foreground"),children:r<t?(0,a.jsx)(S.Z,{className:"w-5 h-5"}):(0,a.jsx)("span",{className:"text-sm font-medium",children:r+1})}),(0,a.jsx)("span",{className:"ml-2 text-sm font-medium ".concat(r<=t?"text-foreground":"text-muted-foreground"),children:e}),r<s.length-1&&(0,a.jsx)("div",{className:"ml-4 w-10 h-0.5 bg-muted-foreground/30"})]},e))})}let O=[{id:"E-1-ALL",name:"E-1",description:"Flat Rate (Tiered Pricing)",season:"All Year"},{id:"E-TOU-C-W",name:"E-TOU-C",description:"Time-of-Use (4-9pm Peak)",season:"Winter"},{id:"E-TOU-C-S",name:"E-TOU-C",description:"Time-of-Use (4-9pm Peak)",season:"Summer"},{id:"E-TOU-D-W",name:"E-TOU-D",description:"Time-of-Use (3-8pm Peak)",season:"Winter"},{id:"E-TOU-D-S",name:"E-TOU-D",description:"Time-of-Use (3-8pm Peak)",season:"Summer"},{id:"EV2-A-W",name:"EV2-A",description:"Time-of-Use (EV Owners)",season:"Winter"},{id:"EV2-A-S",name:"EV2-A",description:"Time-of-Use (EV Owners)",season:"Summer"}];function _(){let[e,t]=(0,r.useState)(1),[s,p]=(0,r.useState)("upload"),[h,N]=(0,r.useState)(null),[k,C]=(0,r.useState)(""),[E,S]=(0,r.useState)(!1),[_,D]=(0,r.useState)({name:"",email:"",rate_schedule:"",peak_kwh:"",offpeak_kwh:""}),[T,I]=(0,r.useState)(null),U=(0,n.useRouter)(),Z=async e=>{if(e.preventDefault(),I(null),"upload"===s&&!h){C("Please upload a PDF file");return}S(!0);try{let e=null;if("upload"===s&&h){let t=h.name.split(".").pop(),s="".concat(Date.now(),"-").concat(Math.random(),".").concat(t),{error:a}=await x.O.storage.from("pdfs").upload(s,h);if(a)throw a;e=s}let{data:t,error:a}=await x.O.from("submissions").insert([{name:_.name,email:_.email,pdf_path:e,..."manual"===s?{rate_schedule:_.rate_schedule,peak_kwh:_.peak_kwh?parseFloat(_.peak_kwh):null,offpeak_kwh:_.offpeak_kwh?parseFloat(_.offpeak_kwh):null}:{rate_schedule:null,peak_kwh:null,offpeak_kwh:null}}]).select().single();if(a)throw a;let r=new FormData;r.append("name",_.name),r.append("email",_.email),h&&r.append("file",h),Object.entries(_).forEach(e=>{let[t,s]=e;s&&r.append(t,s.toString())});try{(await fetch("/api/submit-bill",{method:"POST",body:r})).ok||console.error("Failed to send email notification, but data was saved"),U.replace("/confirmation")}catch(e){console.error("Failed to send email notification, but data was saved:",e),U.replace("/confirmation")}}catch(e){console.error("Submission error:",e),I(e instanceof Error?e.message:"An unexpected error occurred. Please try again.")}finally{S(!1)}},R=e=>t=>{D(s=>({...s,[e]:t.target.value}))},z=e=>(0,a.jsx)(g,{children:(0,a.jsxs)(b,{children:[(0,a.jsx)(j,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsx)(v,{children:(0,a.jsx)("p",{className:"max-w-xs text-sm",children:e})})]})});return(0,a.jsxs)("div",{className:"relative min-h-screen",children:[(0,a.jsx)("div",{className:"absolute inset-0 wave-background"}),(0,a.jsx)("div",{className:"relative container mx-auto px-4 py-10",children:(0,a.jsxs)("div",{className:"mx-auto max-w-3xl",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:"Calculate Your PG&E Savings"}),(0,a.jsx)("p",{className:"mt-3 text-lg text-muted-foreground",children:"Enter your details below and we'll analyze your potential savings"})]}),(0,a.jsx)(P,{currentStep:e,steps:["Personal Information","Bill Details"]}),(0,a.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,a.jsxs)("form",{onSubmit:Z,className:"space-y-6",children:[1===e&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-foreground",children:"Full Name"}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:_.name,onChange:R("name"),className:"mt-1 block w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder-muted-foreground shadow-sm focus:border-accent focus:outline-none focus:ring-1 focus:ring-accent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-foreground",children:"Email Address"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:_.email,onChange:R("email"),className:"mt-1 block w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder-muted-foreground shadow-sm focus:border-accent focus:outline-none focus:ring-1 focus:ring-accent",required:!0})]})]}),2===e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,a.jsxs)("button",{type:"button",className:"flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-colors ".concat("upload"===s?"bg-accent text-accent-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"),onClick:()=>p("upload"),children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),"Upload PDF"]}),(0,a.jsxs)("button",{type:"button",className:"flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-colors ".concat("manual"===s?"bg-accent text-accent-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"),onClick:()=>p("manual"),children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),"Enter Manually"]})]}),"upload"===s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F,{}),(0,a.jsxs)("div",{className:"relative rounded-lg border-2 border-dashed p-8 text-center transition-colors\n                          ".concat(h?"border-accent bg-accent/5":"border-muted-foreground/25 hover:border-muted-foreground/50","\n                        "),onDrop:e=>{e.preventDefault();let t=e.dataTransfer.files[0];(null==t?void 0:t.type)==="application/pdf"?(N(t),C("")):C("Please upload a PDF file")},onDragOver:e=>{e.preventDefault()},children:[(0,a.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(C(""),s){if("application/pdf"!==s.type){C("Please upload a PDF file");return}if(s.size>10485760){C("File size should be less than 10MB");return}N(s)}},className:"hidden",id:"file-upload"}),h?(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.Z,{className:"h-8 w-8 text-accent"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:h.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(h.size/1024/1024).toFixed(2)," MB"]})]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{N(null),C("")},className:"rounded-full p-1 hover:bg-muted",children:(0,a.jsx)(c.Z,{className:"h-5 w-5 text-muted-foreground"})})]}):(0,a.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,a.jsx)(i.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-2 text-sm font-medium",children:"Drop your PG&E bill here or click to upload"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Supports PDF format only"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"rounded-lg border bg-card/50 p-6",children:[(0,a.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:"Rate Schedule"}),(0,a.jsx)("div",{className:"grid gap-4",children:(0,a.jsxs)("div",{className:"max-w-md",children:[(0,a.jsxs)("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium",children:["Select Rate Schedule",z("Choose your PG&E rate schedule and season")]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("select",{value:_.rate_schedule,onChange:R("rate_schedule"),className:"w-full rounded-lg border bg-background px-3 py-2 pr-8 text-sm appearance-none",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select a rate schedule..."}),O.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - ",e.description," (",e.season,")"]},e.id))]}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,a.jsx)("svg",{className:"h-4 w-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-card/50 p-6",children:[(0,a.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:"Energy Charges"}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium",children:["Peak Usage (kWh)",z("Electricity used during peak hours")]}),(0,a.jsx)("input",{type:"number",step:"0.000001",value:_.peak_kwh,onChange:R("peak_kwh"),className:"w-full rounded-lg border bg-background p-2 text-sm",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"mb-2 flex items-center gap-2 text-sm font-medium",children:["Off-Peak Usage (kWh)",z("Electricity used during off-peak hours")]}),(0,a.jsx)("input",{type:"number",step:"0.000001",value:_.offpeak_kwh,onChange:R("offpeak_kwh"),className:"w-full rounded-lg border bg-background p-2 text-sm",required:!0})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border bg-muted p-4 text-sm text-muted-foreground",children:[(0,a.jsx)(m.Z,{className:"mb-2 h-5 w-5"}),(0,a.jsx)("p",{children:"Within 24 hours, we'll analyze your bill and email you the results with potential savings opportunities."})]})]})]}),k&&"upload"===s&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(y,{children:k})}),T&&(0,a.jsx)(w,{variant:"destructive",children:(0,a.jsx)(y,{children:T})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[2===e&&(0,a.jsxs)("button",{type:"button",onClick:()=>{2===e&&t(1)},className:"flex items-center justify-center rounded-lg bg-muted px-4 py-2 text-sm font-medium text-muted-foreground hover:bg-muted/80 transition-colors",children:[(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),1===e?(0,a.jsxs)("button",{type:"button",onClick:()=>{1===e&&_.name&&_.email&&t(2)},className:"ml-auto flex items-center justify-center rounded-lg bg-accent px-4 py-2 text-sm font-medium text-accent-foreground hover:bg-accent/90 transition-colors",disabled:!_.name||!_.email,children:["Next",(0,a.jsx)(f.Z,{className:"ml-2 h-4 w-4"})]}):(0,a.jsxs)("button",{type:"submit",disabled:E,className:"ml-auto flex items-center justify-center rounded-lg bg-accent px-4 py-4 text-sm font-medium text-accent-foreground hover:bg-accent/90 disabled:opacity-50 transition-colors",children:[E?"Submitting...":"Analyze My Bill",(0,a.jsx)(f.Z,{className:"ml-2 h-4 w-4"})]})]})]})})]})})]})}},6070:function(e,t,s){"use strict";s.d(t,{Zb:function(){return l}});var a=s(7437),r=s(2265),n=s(4508);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});l.displayName="Card",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})}).displayName="CardHeader",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})}).displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})}).displayName="CardDescription",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})}).displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"},2141:function(e,t,s){"use strict";s.d(t,{O:function(){return a}});let a=(0,s(3777).eI)("https://umuqydzeqqifiywqsxec.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtdXF5ZHplcXFpZml5d3FzeGVjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg5ODM5NzMsImV4cCI6MjA1NDU1OTk3M30.2cudPRraCD6W4oolwfnH5ZYm1CN9FOSkrs-brtsEEbk",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},4508:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(1994),r=s(3335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[777,159,502,971,117,744],function(){return e(e.s=5366)}),_N_E=e.O()}]);